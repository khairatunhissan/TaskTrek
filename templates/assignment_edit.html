{% extends "base.html" %}
{% block content %}
<h1 class="page">Edit Assignment</h1>

<form method="post" class="card">
  <label>Title
    <input name="title" required value="{{ assignment.title }}">
  </label>

  <label>Problems & Points
    <div class="problem-list"
         style="max-height:220px; overflow-y:auto;
                border:1px solid #ddd; border-radius:8px;
                padding:0.5rem 0.75rem;">
      {% for p in problems %}
        {% set checked = (p.id in selected_problem_ids) %}
        {% set pts = problem_points.get(p.id, 3) %}
        <div class="problem-row"
             style="display:flex; align-items:center; justify-content:space-between; margin-bottom:0.25rem;">
          <label style="flex:1;">
            <input type="checkbox" name="problem_ids" value="{{ p.id }}"
                   {% if checked %}checked{% endif %}>
            {{ p.title }}
          </label>
          <input type="number"
                 name="points_{{ p.id }}"
                 min="0"
                 value="{{ pts }}"
                 style="width:5rem; margin-left:0.5rem;" />
        </div>
      {% endfor %}
    </div>
    <small class="muted">
      Check a problem and set how many points it is worth.
    </small>
  </label>

  <label>Students
    <select name="student_ids" multiple size="8"
            style="max-height:220px; overflow-y:auto;">
      {% for s in students %}
        <option value="{{ s.id }}"
                {% if s.id in current_student_ids %}selected{% endif %}>
          {{ s.email }}
        </option>
      {% endfor %}
    </select>
  </label>

  <label>Note (optional)
    <textarea name="note" rows="3" placeholder="e.g., Complete by Friday.">{{ note or "" }}</textarea>
  </label>

  <button class="btn primary" type="submit">Save Changes</button>
  <a class="btn" href="{{ url_for('assignments') }}"
     style="display:block; text-align:center;">
    Cancel
  </a>
</form>
{% endblock %}
